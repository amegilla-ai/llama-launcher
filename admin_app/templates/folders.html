<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Scan Configuration</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root{
            --bg:#f8fafc; --card:#fff; --primary:#4f46e5;
            --text:#1e293b; --muted:#64748b; --border:#e2e8f0;
        }
        body{margin:0;font-family:'Inter', system-ui, sans-serif;background:var(--bg);color:var(--text);}
        .container{max-width:900px;margin:2rem auto;padding:0 1rem;}
        h2{font-size:1.4rem;color:var(--primary);margin-bottom:.5rem;}
        .field{margin-bottom:1rem;}
        label{display:block;font-weight:600;margin-bottom:.3rem;color:var(--muted);}
        input[type=text]{width:100%;padding:.5rem .8rem;border:1px solid var(--border);border-radius:6px;}
        textarea{width:100%;height:8rem;padding:.5rem .8rem;border:1px solid var(--border);border-radius:6px;resize:vertical;font-family:monospace;}
        .actions{margin-top:1.5rem;display:flex;gap:.8rem;}
        .btn{background:var(--primary);color:#fff;padding:.5rem 1.2rem;border:none;border-radius:6px;cursor:pointer;}
        .btn-secondary{background:var(--bg);color:var(--muted);border:1px solid var(--border);}
    </style>
</head>
<body>
<div class="container">
    <h2>Scan Configuration</h2>

    <form method="POST" action="/save-folders">
        <!-- ---- llama.cpp binary paths ----------------------------------- -->
        <div class="field">
            <label for="server_gpu_bin">llama.cpp Server GPU binary</label>
            <input type="text" id="server_gpu_bin" name="server_gpu_bin"
                   value="{{ folders_cfg.llama_server_gpu_bin|e }}">
        </div>

        <div class="field">
            <label for="server_cpu_bin">llama.cpp Server CPU binary</label>
            <input type="text" id="server_cpu_bin" name="server_cpu_bin"
                   value="{{ folders_cfg.llama_server_cpu_bin|e }}">
        </div>

        <div class="field">
            <label for="cli_gpu_bin">llama.cpp CLI GPU binary</label>
            <input type="text" id="cli_gpu_bin" name="cli_gpu_bin"
                   value="{{ folders_cfg.llama_cli_gpu_bin|e }}">
        </div>

        <div class="field">
            <label for="cli_cpu_bin">llama.cpp CLI CPU binary</label>
            <input type="text" id="cli_cpu_bin" name="cli_cpu_bin"
                   value="{{ folders_cfg.llama_cli_cpu_bin|e }}">
        </div>
<div class="field">
            <label for="cli_cpu_bin">llama.cpp CLI CPU binary</label>
            <input type="text" id="cli_cpu_bin" name="cli_cpu_bin"
                   value="{{ folders_cfg.llama_cli_cpu_bin|e }}">
        </div>

        <!-- adding default folder for llama server -->
        <div class="field">
            <label for="llama_server_models_dir">Llama Server Models Directory</label>
            <small style="color:var(--muted);display:block;margin-bottom:.5rem;">
                Select which folder llama-server should use for --models-dir (leave empty to use first folder)
            </small>
            <select id="llama_server_models_dir" name="llama_server_models_dir" style="width:100%;padding:.5rem;border:1px solid var(--border);border-radius:6px;margin-bottom:.5rem;">
                <option value="">-- Use first folder from list --</option>
                {% for folder in folders_cfg.folders %}
                <option value="{{ folder }}" {% if folders_cfg.llama_server_models_dir == folder %}selected{% endif %}>{{ folder }}</option>
                {% endfor %}
            </select>
            <small style="color:var(--muted);display:block;margin-bottom:.3rem;">Or enter custom path:</small>
            <input type="text" name="llama_server_models_dir_custom" placeholder="Custom path (overrides dropdown)"
                   value="{% if folders_cfg.llama_server_models_dir and folders_cfg.llama_server_models_dir not in folders_cfg.folders %}{{ folders_cfg.llama_server_models_dir }}{% endif %}">
        </div>

        <!-- ---- Folder list ------------------------------------------ -->
        <div class="field">
            <label for="folders">Folders to scan (one per line)</label>
            <textarea id="folders" name="folders">{{ folders_cfg.folders|join('\n') }}</textarea>
        </div>

        <div class="actions">
            <button type="submit" class="btn">Save</button>
            <label style="display:flex;align-items:center;gap:.3rem;">
                <input type="checkbox" name="rescan" value="1">
                Rescan now
            </label>
            <a href="/" class="btn-secondary">Cancel</a>
        </div>
    </form>
</div>
</body>